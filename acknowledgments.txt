Thanks to Coder Coder for help in parts
